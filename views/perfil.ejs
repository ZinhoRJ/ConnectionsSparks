<% if (nameCookie) { %>
    <div style="text-align: center; margin-bottom: 5%;">
        <b>LOGIN COMO: </b>
        <a href="/post/<%= idCookie %>">
            <%= nameCookie %> <i class="material-symbols-outlined" style="font-size: 1rem;">north_east</i>
        </a>
    </div>
<% } %>

<style>
    * {
    box-sizing: border-box;
    padding: 0;
    }

    body {
        background-color: rgb(13, 2, 38);
        background-image: none;
    }


.container-here {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
}

.profile {
    display: flex;
    flex-direction: column;
    align-items: center;
    flex: 1 1 200px;
    background-color: #2c2a2a;
    padding: 20px;
    border-radius: 8px;
    border: 1.9px solid blueviolet;
}

.profile-image {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    border: 1.9px solid;
    /* Define a espessura da borda */
    border-color: #b100f7;
    /* Define a cor roxa da borda */
}

.profile-info {
    text-align: center;
    margin-top: 10px;
}

.profile-info h2 {
    margin-bottom: 10px;
}

.btn {
    margin: 5px 0;
    padding: 10px 15px;
    background-color: blueviolet;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}

.details {
    flex: 2 1 400px;
    background-color: #2c2a2a;
    padding: 20px;
    border-radius: 8px;
    border: 1px solid #ccc;
}

.details p {
    margin-bottom: 10px;
    word-wrap: break-word;
}

.details b {
    display: inline-block;
    width: 150px;
}

.tags-container {
    display: flex;
    align-items: flex-start;
}

.tags {
    flex: 1;
    display: flex;
    flex-wrap: wrap;
    gap: 0px;
    background-color: #2c2a2a;
    padding: 5px;
    margin-bottom: 10px;
    border-radius: 0px;
    margin-left: 0px; /* Espaçamento entre o texto e as tags */
}

.tags::before {
    content: '';
    width: 100%
}



.comment-box {
    display: flex;
    align-items: flex-start;
    margin: 5px 0;
    border-bottom: 1px solid #ccc;
    padding-bottom: 20px;
}

.profile-image-posts {
    width: 80px;
    /* Ajuste esse valor para o tamanho desejado */
    height: 80px;
    /* Ajuste esse valor para o tamanho desejado */
    border-radius: 50%;
    margin-right: 20px;
    border: 1.9px solid;
    /* Define a espessura da borda */
    border-color: #b100f7;
    /* Define a cor roxa da borda */
}

.comment-content {
    max-width: 600px;
    flex-grow: 1;
}

.comment-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: -20px;
    margin-top: -20px;
}

.comment-body {
    margin: 10px 0;
}

.comment-buttons {
    display: flex;
    gap: 10px;
}

.btn {
    padding: 5px 10px;
    background-color: #1da1f2;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}
</style>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />



<div class="container-here">
    <div class="profile">
        <img src="<%= data.imagem %>" alt="Foto de Perfil" class="profile-image">
        <div class="profile-info">
            <h2 style="margin-top: -5px;"><%= data.title %></h2> <!-- Nome do Usuáruo -->

            <!-- Curtidas -->
            <p>Curtidas: <label type="number" id="numeroCurtidas">
                <%= data.curtidas.length %>
            </p>
            
            <!-- Botão Constelação -->
            <a href="/verify/<%= data.id %>" class="btn" style="margin-bottom: 10px;">
                <span class="material-symbols-outlined" style="color:yellow; font-size: medium;">
                    star
                </span>
                VER CONSTELAÇÃO
                <span class="material-symbols-outlined" style="color:yellow; font-size: medium;">
                    star
                </span>
            </a>

            <div>
            <!-- Botão Editar -->
            <% if (data._id==idCookie) { %>
                <a href="/editar-perfil/<%= data._id %>" class="btn"> Editar Perfil </a>
            <% } %>

            
                <!-- Botão Curtir -->
            <% if (!data.curtidas.includes(idCookie)) { %>
                <form action="/curtir/<%= data.id %>" method="POST">
                    <input type="submit" value="Curtir" class="btn">
                </form>
            <% } %>
            
            <!-- Botão Caso já esteja curtido -->
            <% if (data.curtidas.includes(idCookie)) { %>
                <form action="/descurtir-perfil/<%= data.id %>?_method=POST" method="POST">
                    <button class="btn-descurtir">Curtido!</button>
                </form>
            <% } %>
            </div>
            
        </div>
    </div>
    <div class="details">
        <p><b>Instagram:</b> <a href="https://instagram.com/<%= data.insta %>" target="_blank"> @<%= data.insta %> </a></p>
        <p><b>Sexo:</b> <%= data.sexo %> </p>
        <p><b>Data de Nascimento:</b> <%= localDateFormatted %> </p>
        <div class="tags-container">
            <p><b>Tags de Interesse:</b> </p>
            <div class="tags">
                <%= tagsFormatadas%>
            </div>
        </div>
        <div class="tags-container">
            <p><b>Biografia:</b> </p>
            <div class="tags">
                <%= data.body %> 
            </div>
        </div>
    </div>
</div>



<% if (idCookie==data._id) { %>
    <form action="/public-post/<%= data.id %>" method="POST" style="margin-top: 20px;">
        <h3>CRIAR POST:</h3>

        <div style="display: flex; margin-top: 10px;">
            <img src="<%= pfpCookie %>" class="foto-perfil">
            <div style="flex: 1; padding-left: 20px;">

                <b>
                    <%= nameCookie %>
                </b> - <font color="grey"><i>(Por favor, mantenha o respeito.)</i></font>

                <textarea name="texto" id="texto" coLs="50" rows="4" maxlength="200" placeholder="No que você está pensando, <%= data.title %>?" 
                    oninput="atualizarContador()" style="resize:none; width: 100%; height: 38%;"></textarea>

                <div style="display: flex; align-items: center;">
                    <input type="submit" value="Adicionar" class="btn">
                    <div id="contador" style="padding-left: 2%;"></div>
                </div>

            </div>
        </div>
    </form>
<% } %>



<h3>POSTS:</h3>

                <% postsOrdenados.forEach(posts=> { %>
                    <% if (posts.idResposta===data.id) { %>
                        <div class="comment-box" style="margin-bottom: 3%;">
                            <img src="<%= posts.imagem %>" alt="Imagem de Perfil" class="profile-image-posts" />
                            <div class="comment-content">
                                <div class="comment-header">
                                    <h3>
                                        <%= posts.assinatura %>
                                    </h3>
                                </div>
                                <div class="comment-body">
                                    <p>
                                        <%= posts.texto %>
                                    </p>
                                </div>
                                <div class="comment-buttons">

                                    <% if (!posts.likes.includes(idCookie)) { %>
                                        <form action="/curtir-post/<%= posts._id %>?_method=POST" method="POST">
                                            <button class="btn">Curtir</button>
                                        </form>
                                        <% } %>

                                            <% if (posts.likes.includes(idCookie)) { %>
                                                <form action="/descurtir-post/<%= posts._id %>?_method=POST"
                                                    method="POST">
                                                    <button class="btn-descurtir">Curtido!</button>
                                                </form>
                                                <% } %>

                                                    <div style="align-content: center">
                                                        <font color="yellow"> &starf; </font>
                                                        Curtidas: <%= posts.likes.length %>
                                                    </div>

                                                    <a href="/ver-post/<%= posts._id %>">
                                                        <button class="btn">Responder</button>
                                                    </a>


                                                    <% if (idCookie==data._id) { %>
                                                        <div>
                                                            <form
                                                                action="/delete-post-user/<%= posts._id %>?_method=DELETE"
                                                                method="POST">
                                                                <button class="btn"
                                                                    style="background-image: linear-gradient(#f80000, #942307);">Apagar</button>
                                                            </form>
                                                        </div>
                                                        <% } %>
                                </div>
                            </div>
                        </div>

                        <% } %>
                            <% }) %>


<script>
    function atualizarContador() { //contador de letras dos comentários!
        var input = document.getElementById('texto');
        var contador = document.getElementById('contador');
        var caracteresRestantes = 200 - input.value.length;
        contador.textContent = "Caracteres restantes: " + caracteresRestantes + "/200";
    };
</script>

<div class="star" style="top: 56%; left: 25%;"></div>
<div class="star" style="top: 24%; left: 68%;"></div>
<div class="star" style="top: 74%; left: 42%;"></div>
<div class="star" style="top: 16%; left: 20%;"></div>
<div class="star" style="top: 34%; left: 40%;"></div>
<div class="star" style="top: 11%; left: 60%;"></div>
<div class="star" style="top: 10%; left: 22%;"></div>
<div class="star" style="top: 10%; left: 95%;"></div>
<div class="star" style="top: 50%; left: 54%;"></div>
<div class="star" style="top: 15%; left: 90%;"></div>
<div class="star" style="top: 30%; left: 10%;"></div>
<div class="star" style="top: 80%; left: 10%;"></div>
<div class="star" style="top: 80%; left: 60%;"></div>
<div class="star" style="top: 12%; left: 34%;"></div>
<div class="star" style="top: 67%; left: 22%;"></div>
<div class="star" style="top: 58%; left: 75%;"></div>
<div class="star" style="top: 9%; left: 49%;"></div>
<div class="star" style="top: 45%; left: 37%;"></div>
<div class="star" style="top: 21%; left: 83%;"></div>
<div class="star" style="top: 4%; left: 12%;"></div>
<div class="star" style="top: 33%; left: 88%;"></div>
<div class="star" style="top: 78%; left: 56%;"></div>
<div class="star" style="top: 25%; left: 92%;"></div>
<div class="star" style="top: 68%; left: 8%;"></div>
<div class="star" style="top: 77%; left: 39%;"></div>
<div class="star" style="top: 83%; left: 69%;"></div>